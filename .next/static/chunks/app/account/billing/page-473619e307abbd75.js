(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[113],{659:function(e,r,s){Promise.resolve().then(s.bind(s,3431))},3431:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return p}});var t=s(7437),a=s(2265),n=s(8933),i=s(2381),l=s(9820),c=s(9174),o=s(5302),d=s(3639),u=s(5131),m=s(1047),x=s(8226),h=s(6744),f=s(6362),g=s(257);function p(){let[e,r]=(0,a.useState)(null),[s,p]=(0,a.useState)(!0),[b,v]=(0,a.useState)(!1);(0,a.useEffect)(()=>{N()},[]);let N=async()=>{try{let{data:{user:e}}=await n.OQ.auth.getUser();if(!e)return;let{data:s,error:t}=await n.OQ.from("subscription_status").select("*").eq("user_id",e.id).single();if(t||!s){console.error("Error fetching subscription:",t),p(!1);return}let a=j(s.stripe_price_id||"");r({status:s.status||"inactive",current_period_end:s.current_period_end||"",stripe_price_id:s.stripe_price_id||"",plan_name:a.name,amount:a.amount,interval:a.interval})}catch(e){console.error("Error:",e)}finally{p(!1)}},j=e=>({[g.env.NEXT_PUBLIC_STRIPE_STARTER_MONTHLY_PRICE_ID||""]:{name:"Starter",amount:27,interval:"month"},[g.env.NEXT_PUBLIC_STRIPE_STARTER_ANNUAL_PRICE_ID||""]:{name:"Starter",amount:270,interval:"year"},[g.env.NEXT_PUBLIC_STRIPE_PRO_MONTHLY_PRICE_ID||""]:{name:"Agency Pro",amount:97,interval:"month"},[g.env.NEXT_PUBLIC_STRIPE_PRO_ANNUAL_PRICE_ID||""]:{name:"Agency Pro",amount:970,interval:"year"},[g.env.NEXT_PUBLIC_STRIPE_ACCELERATOR_MONTHLY_PRICE_ID||""]:{name:"Accelerator",amount:197,interval:"month"},[g.env.NEXT_PUBLIC_STRIPE_ACCELERATOR_ANNUAL_PRICE_ID||""]:{name:"Accelerator",amount:1970,interval:"year"}})[e]||{name:"Unknown Plan",amount:0,interval:"month"},y=async()=>{v(!0);try{let{data:{user:e}}=await n.OQ.auth.getUser();if(!e)return;let r=await fetch("/api/stripe/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id})}),{url:s,error:t}=await r.json();if(t){console.error("Error creating portal session:",t);return}s&&(window.location.href=s)}catch(e){console.error("Error:",e)}finally{v(!1)}};return s?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-4"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-8"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded"}),(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded"})]})]})})}):e?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Billing & Subscription"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage your subscription and billing information"})]}),(0,t.jsxs)(l.Zb,{className:"mb-8",children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[(e=>{switch(e){case"active":return(0,t.jsx)(o.Z,{className:"w-5 h-5 text-green-500"});case"trialing":return(0,t.jsx)(o.Z,{className:"w-5 h-5 text-blue-500"});case"past_due":return(0,t.jsx)(d.Z,{className:"w-5 h-5 text-yellow-500"});case"canceled":return(0,t.jsx)(u.Z,{className:"w-5 h-5 text-red-500"});default:return(0,t.jsx)(u.Z,{className:"w-5 h-5 text-gray-500"})}})(e.status),"Current Plan"]}),(0,t.jsxs)(l.SZ,{children:[e.plan_name," - $",e.amount,"/",e.interval]})]}),(e=>{switch(e){case"active":return(0,t.jsx)(c.C,{className:"bg-green-100 text-green-800",children:"Active"});case"trialing":return(0,t.jsx)(c.C,{className:"bg-blue-100 text-blue-800",children:"Trial"});case"past_due":return(0,t.jsx)(c.C,{className:"bg-yellow-100 text-yellow-800",children:"Past Due"});case"canceled":return(0,t.jsx)(c.C,{className:"bg-red-100 text-red-800",children:"Canceled"});default:return(0,t.jsx)(c.C,{className:"bg-gray-100 text-gray-800",children:"Inactive"})}})(e.status)]})}),(0,t.jsx)(l.aY,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 text-gray-500"}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Next billing: ",new Date(e.current_period_end).toLocaleDateString()]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x.Z,{className:"w-4 h-4 text-gray-500"}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Billed ",e.interval,"ly"]})]})]})})]}),(0,t.jsxs)(l.Zb,{className:"mb-8",children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsx)(l.ll,{children:"Billing Management"}),(0,t.jsx)(l.SZ,{children:"Update your payment method, view invoices, or change your plan"})]}),(0,t.jsx)(l.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(i.z,{onClick:y,disabled:b,className:"w-full md:w-auto",children:b?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(f.Z,{className:"w-4 h-4 mr-2"}),"Manage Billing"]})}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,t.jsx)("p",{children:"• Update payment methods"}),(0,t.jsx)("p",{children:"• Download invoices"}),(0,t.jsx)("p",{children:"• Change subscription plan"}),(0,t.jsx)("p",{children:"• Cancel subscription"})]})]})})]}),"past_due"===e.status&&(0,t.jsxs)(l.Zb,{className:"mb-8 border-yellow-200 bg-yellow-50",children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"flex items-center gap-2 text-yellow-800",children:[(0,t.jsx)(d.Z,{className:"w-5 h-5"}),"Payment Required"]})}),(0,t.jsxs)(l.aY,{children:[(0,t.jsx)("p",{className:"text-yellow-700 mb-4",children:"Your payment failed. Please update your payment method to continue using the service."}),(0,t.jsx)(i.z,{onClick:y,className:"bg-yellow-600 hover:bg-yellow-700",children:"Update Payment Method"})]})]}),"canceled"===e.status&&(0,t.jsxs)(l.Zb,{className:"mb-8 border-red-200 bg-red-50",children:[(0,t.jsx)(l.Ol,{children:(0,t.jsxs)(l.ll,{className:"flex items-center gap-2 text-red-800",children:[(0,t.jsx)(u.Z,{className:"w-5 h-5"}),"Subscription Canceled"]})}),(0,t.jsxs)(l.aY,{children:[(0,t.jsx)("p",{className:"text-red-700 mb-4",children:"Your subscription has been canceled. You can resubscribe at any time."}),(0,t.jsx)(i.z,{onClick:()=>window.location.href="/subscribe",className:"bg-red-600 hover:bg-red-700",children:"Resubscribe"})]})]}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsxs)(i.z,{variant:"outline",onClick:N,disabled:s,children:[(0,t.jsx)(h.Z,{className:"w-4 h-4 mr-2 ".concat(s?"animate-spin":"")}),"Refresh Status"]})})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"No Active Subscription"}),(0,t.jsx)("p",{className:"text-gray-600 mb-8",children:"You don't have an active subscription. Subscribe to access all features."}),(0,t.jsx)(i.z,{onClick:()=>window.location.href="/subscribe",children:"View Plans"})]})})})}},9174:function(e,r,s){"use strict";s.d(r,{C:function(){return l}});var t=s(7437);s(2265);var a=s(535),n=s(3448);let i=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:s,...a}=e;return(0,t.jsx)("div",{className:(0,n.cn)(i({variant:s}),r),...a})}},2381:function(e,r,s){"use strict";s.d(r,{z:function(){return o}});var t=s(7437),a=s(2265),n=s(7053),i=s(535),l=s(3448);let c=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,r)=>{let{className:s,variant:a,size:i,asChild:o=!1,...d}=e,u=o?n.g7:"button";return(0,t.jsx)(u,{className:(0,l.cn)(c({variant:a,size:i,className:s})),ref:r,...d})});o.displayName="Button"},9820:function(e,r,s){"use strict";s.d(r,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var t=s(7437),a=s(2265),n=s(3448);let i=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let l=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...a})});l.displayName="CardHeader";let c=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let o=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",s),...a})});o.displayName="CardDescription";let d=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",s),...a})});d.displayName="CardContent";let u=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},8933:function(e,r,s){"use strict";s.d(r,{OQ:function(){return t}});let t=(0,s(1545).eI)("https://bafqocuimkfjnuhvhsat.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJhZnFvY3VpbWtmam51aHZoc2F0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0NDQ2NTcsImV4cCI6MjA3NzAyMDY1N30.ary_R34tb_jAuM2QddZBpWZM7DktoISmDAtDDDSU0LM",{auth:{storage:window.localStorage,persistSession:!0,autoRefreshToken:!0}})},3448:function(e,r,s){"use strict";s.d(r,{cn:function(){return n}});var t=s(1994),a=s(3335);function n(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,a.m6)((0,t.W)(r))}}},function(e){e.O(0,[284,545,518,971,117,744],function(){return e(e.s=659)}),_N_E=e.O()}]);